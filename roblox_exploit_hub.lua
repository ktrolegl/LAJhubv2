--[[
    LAJ HUB V3.0 ULTRA - Premium Roblox Exploit Hub
    Developed by: LAJ Development Team
    
    Features:
    - Advanced script organization by game & category
    - Script search and favorites system
    - Player utilities (ESP, teleport, etc.)
    - Auto-execute functionality
    - Custom theme settings
    - Premium scripts with special access
    - Executor compatibility checks
    - Game detection and script recommendations
    
    Discord: discord.gg/lajhubcommunity
]]

-- Check if the executor has proper functions
local executorFunctions = {
    ["HttpGet"] = (syn and syn.request) or (http and http.request) or (game and game.HttpGet) or (request),
    ["Execute"] = loadstring,
    ["FileSystem"] = (writefile and readfile and isfile) ~= nil
}

-- Initialize UI with error handling
local Success, Rayfield = pcall(function()
    return loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
end)

if not Success then
    -- Fallback UI if Rayfield fails
    loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
    error("Failed to load Rayfield UI. Loaded Infinite Yield as fallback.")
    return
end

-- Set up global utilities
local LAJ = {
    Version = "3.0 ULTRA",
    Config = {},
    Cache = {},
    Favorites = {},
    History = {},
    API = {}
}

-- Advanced error handling and logging
LAJ.Log = function(type, message)
    local colors = {
        ["Info"] = Color3.fromRGB(0, 255, 255),
        ["Success"] = Color3.fromRGB(0, 255, 0),
        ["Warning"] = Color3.fromRGB(255, 255, 0),
        ["Error"] = Color3.fromRGB(255, 0, 0),
        ["Debug"] = Color3.fromRGB(180, 180, 180)
    }
    
    if type == "Error" then
        warn("[LAJ HUB] " .. message)
    elseif type == "Debug" then
        print("[LAJ DEBUG] " .. message)
    end
    
    if Rayfield then
        Rayfield:Notify({
            Title = "LAJ HUB " .. type,
            Content = message,
            Duration = (type == "Error" and 6) or (type == "Warning" and 4) or 3,
            Image = 4483362458,
            Actions = (type == "Error") and {
                Ignore = {
                    Name = "OK",
                    Callback = function() end
                },
                Report = {
                    Name = "Copy Error",
                    Callback = function()
                        if setclipboard then
                            setclipboard("[LAJ HUB Error Report]\nVersion: " .. LAJ.Version .. "\nError: " .. message)
                            Rayfield:Notify({
                                Title = "Error Copied",
                                Content = "Error details copied to clipboard",
                                Duration = 3
                            })
                        end
                    end
                }
            } or nil
        })
    end
    
    -- Log to file system if available
    if executorFunctions.FileSystem then
        local logFile = "LAJHub_Logs.txt"
        local logContent = ""
        
        if isfile(logFile) then
            logContent = readfile(logFile)
        end
        
        local timestamp = os.date("%Y-%m-%d %H:%M:%S")
        logContent = logContent .. "[" .. timestamp .. "] [" .. type .. "] " .. message .. "\n"
        
        -- Limit log size
        if #logContent > 50000 then
            logContent = string.sub(logContent, #logContent - 50000)
        end
        
        writefile(logFile, logContent)
    end
    
    return message
end

-- Enhanced script loader with error tracking
LAJ.LoadScript = function(url, name)
    LAJ.Log("Info", "Loading " .. name .. "...")
    
    -- Add to history
    table.insert(LAJ.History, {
        Name = name,
        URL = url,
        Time = os.time()
    })
    
    -- Limit history size
    if #LAJ.History > 20 then
        table.remove(LAJ.History, 1)
    end
    
    -- Save history if file system available
    if executorFunctions.FileSystem then
        writefile("LAJHub_History.json", game:GetService("HttpService"):JSONEncode(LAJ.History))
    end
    
    -- Execute with advanced error handling
    local success, result = pcall(function()
        return loadstring(game:HttpGet(url))()
    end)
    
    if success then
        LAJ.Log("Success", name .. " was successfully executed")
        return true
    else
        LAJ.Log("Error", "Failed to load " .. name .. ": " .. tostring(result))
        return false
    end
end

-- Expanded game detection system
LAJ.Games = {
    -- FPS Games
    ["Phantom Forces"] = {ID = 292439477, Category = "FPS", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/phantom-forces.lua"},
    ["Arsenal"] = {ID = 286090429, Category = "FPS", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/ArsenalOwlHub.lua"},
    ["Bad Business"] = {ID = 3233893879, Category = "FPS", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/bad-business.lua"},
    ["Strucid"] = {ID = 2377868063, Category = "FPS", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/strucid.lua"},
    ["Rush Point"] = {ID = 5993942214, Category = "FPS"},
    ["Apocalypse Rising"] = {ID = 1600503, Category = "FPS", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/ApocalypseRising.lua"},
    ["Big Paintball"] = {ID = 3527629287, Category = "FPS", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/big-paintball.lua"},
    ["Energy Assault"] = {ID = 6172932937, Category = "FPS", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/Energy%20Assault.lua"},
    ["Counter Blox"] = {ID = 301549746, Category = "FPS", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/CounterBlox.lua"},
    ["Those Who Remain"] = {ID = 488667523, Category = "FPS", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/ThoseWhoRemain.lua"},
    
    -- RPG Games
    ["Blox Fruits"] = {ID = 2753915549, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/BloxFruit.lua"},
    ["King Legacy"] = {ID = 4520749081, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/KingLegacy.lua"},
    ["Pet Simulator X"] = {ID = 6284583030, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/PetSimX.lua"},
    ["Anime Fighting Simulator"] = {ID = 4042427666, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/AnimeFighting.lua"},
    ["Shindo Life"] = {ID = 4616652839, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/ShindoLife.lua"},
    ["Your Bizarre Adventure"] = {ID = 2809202155, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/your-bizarre-adventure.lua"},
    ["Anime Dimensions"] = {ID = 6938803611, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/animedimension.lua"},
    ["Dungeon Quest"] = {ID = 2414851778, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/dungeon-quest.lua"},
    ["Slayer Tycoon"] = {ID = 7234162497, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/slayer-tycoon.lua"},
    ["Murder Mystery 2"] = {ID = 142823291, Category = "RPG", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/murder-mystery-2.lua"},
    
    -- Town & City Games
    ["Adopt Me"] = {ID = 920587237, Category = "Town & City", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/adoptme.lua"},
    ["Brookhaven"] = {ID = 4924922222, Category = "Town & City", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/brook-haven.lua"},
    ["MeepCity"] = {ID = 370731277, Category = "Town & City"},
    ["Welcome to Bloxburg"] = {ID = 185655149, Category = "Town & City", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/bloxburg.lua"},
    ["Work at a Pizza Place"] = {ID = 192800, Category = "Town & City", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/work-a-pizza-place.lua"},
    ["My Restaurant"] = {ID = 4490140733, Category = "Town & City", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/my-restaurant.lua"},
    ["Vans World"] = {ID = 6679968919, Category = "Town & City", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/vans-world.lua"},
    ["Royal High"] = {ID = 735030788, Category = "Town & City", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/royal-high.lua"},
    
    -- Fighting Games
    ["Da Hood"] = {ID = 2788229376, Category = "Fighting", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/da-hood.lua"},
    ["Hood Customs"] = {ID = 9183932460, Category = "Fighting"},
    ["Prison Life"] = {ID = 155615604, Category = "Fighting", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/prison-life.lua"},
    ["Breaking Point"] = {ID = 648362523, Category = "Fighting", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/breaking-point.lua"},
    
    -- Simulation Games
    ["Fishing Simulator"] = {ID = 2866967438, Category = "Simulation", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/FishingSim.lua"},
    ["Mining Simulator 2"] = {ID = 9551640993, Category = "Simulation"},
    ["Car Dealership Tycoon"] = {ID = 1554960397, Category = "Simulation"},
    ["Strongman Simulator"] = {ID = 5338710779, Category = "Simulation", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/strongman-simulator.lua"},
    ["Superhero Simulator"] = {ID = 2577423786, Category = "Simulation", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/superheosim.lua"},
    ["BackFlip Simulator"] = {ID = 2481601704, Category = "Simulation", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/BackFlipSim.lua"},
    ["Saber Simulator"] = {ID = 3823781113, Category = "Simulation", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/saber-simulator.lua"},
    ["Bee Swarm Simulator"] = {ID = 1537690962, Category = "Simulation", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/bee-swarm.lua"},
    ["Destruction Simulator"] = {ID = 2248408710, Category = "Simulation", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/destruction-simulator.lua"},
    ["Car Crusher"] = {ID = 13229599, Category = "Simulation", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/car-crusher.lua"},
    
    -- Adventure Games
    ["Jailbreak"] = {ID = 606849621, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/jailbreak.lua"},
    ["Mad City"] = {ID = 1224212277, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/madcity.lua"},
    ["Ninja Legends"] = {ID = 3956818381, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/ninja-legends.lua"},
    ["Tower of Hell"] = {ID = 1962086868, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/tower-of-hell.lua"},
    ["Tower of Misery"] = {ID = 4954752502, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/tower-of-misery.lua"},
    ["The Mimic"] = {ID = 6243699076, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/the-mimic.lua"},
    ["Build A Boat For Treasure"] = {ID = 537413528, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/build-a-boat-for-treasure.lua"},
    ["Shark Bite"] = {ID = 734159876, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/shark-bite.lua"},
    ["Parkour"] = {ID = 445664957, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/parkour.lua"},
    ["Speed Run 4"] = {ID = 183364845, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/speed-run-4.lua"},
    ["Piggy"] = {ID = 4623386862, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/piggy.lua"},
    ["Bedwars"] = {ID = 6872265039, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/bedwars.lua"},
    ["SkyWars"] = {ID = 855499080, Category = "Adventure", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/skywars.lua"},
    
    -- Horror Games
    ["Survive the Killer"] = {ID = 4580204640, Category = "Horror", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/survive-the-killer.lua"},
    ["Zombie Attack"] = {ID = 1240123653, Category = "Horror", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/zombie-attack.lua"},
    ["Zombie Rush"] = {ID = 137885680, Category = "Horror", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/zombie-rush.lua"},
    
    -- Tycoon Games
    ["Super Hero Tycoon"] = {ID = 574407221, Category = "Tycoon", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/super-hero-tycoon.lua"},
    
    -- Other Games
    ["Natural Disaster Survival"] = {ID = 189707, Category = "Other", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/natural-disaster-survival.lua"},
    ["Dinosaur Simulator"] = {ID = 219434352, Category = "Other", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/dinosaur-simulator.lua"},
    ["Broken Bones"] = {ID = 2551991523, Category = "Other", Script = "https://raw.githubusercontent.com/TrixAde/scripts/main/broken-bones.lua"}
}

-- Get current game with more details
LAJ.GetCurrentGame = function()
    local currentGameId = game.PlaceId
    local gameInfo = {
        Name = "Universal",
        ID = currentGameId,
        Category = "Other",
        PlaceVersion = game.PlaceVersion,
        PlaceName = "Unknown",
        Script = nil -- Add Script field to store direct script URL
    }
    
    -- Try to get game name from Roblox
    pcall(function()
        local success, result = pcall(function()
            return game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId)
        end)
        
        if success and result then
            gameInfo.PlaceName = result.Name
        end
    end)
    
    -- Check if game is in our database
    for name, info in pairs(LAJ.Games) do
        if currentGameId == info.ID then
            gameInfo.Name = name
            gameInfo.Category = info.Category
            gameInfo.Script = info.Script -- Store the script URL if available
            break
        end
    end
    
    -- Log game detection
    LAJ.Log("Info", "Detected game: " .. gameInfo.Name .. " (ID: " .. gameInfo.ID .. ")")
    
    return gameInfo
end

-- Enhanced settings management
LAJ.LoadSettings = function()
    if executorFunctions.FileSystem and isfile("LAJHub_Settings.json") then
        local success, result = pcall(function()
            return game:GetService("HttpService"):JSONDecode(readfile("LAJHub_Settings.json"))
        end)
        
        if success and type(result) == "table" then
            LAJ.Log("Info", "Settings loaded successfully")
            return result
        else
            LAJ.Log("Warning", "Failed to load settings, using defaults")
        end
    end
    
    return {
        Theme = "Default",
        AutoExecute = {},
        UIScale = 1,
        Favorites = {},
        RecentScripts = {},
        CustomScripts = {}
    }
end

LAJ.SaveSettings = function()
    if executorFunctions.FileSystem then
        local success, result = pcall(function()
            writefile("LAJHub_Settings.json", game:GetService("HttpService"):JSONEncode(LAJ.Config))
            return true
        end)
        
        if success then
            LAJ.Log("Success", "Settings saved successfully")
            return true
        else
            LAJ.Log("Error", "Failed to save settings: " .. tostring(result))
            return false
        end
    end
    return false
end

-- Initialize settings
LAJ.Config = LAJ.LoadSettings()

-- Set up favorites system
LAJ.IsFavorite = function(scriptName)
    for _, fav in ipairs(LAJ.Config.Favorites or {}) do
        if fav.Name == scriptName then
            return true
        end
    end
    return false
end

LAJ.ToggleFavorite = function(scriptName, scriptUrl)
    LAJ.Config.Favorites = LAJ.Config.Favorites or {}
    
    for i, fav in ipairs(LAJ.Config.Favorites) do
        if fav.Name == scriptName then
            table.remove(LAJ.Config.Favorites, i)
            LAJ.SaveSettings()
            LAJ.Log("Info", "Removed " .. scriptName .. " from favorites")
            return false
        end
    end
    
    table.insert(LAJ.Config.Favorites, {
        Name = scriptName,
        URL = scriptUrl,
        AddedAt = os.time()
    })
    
    LAJ.SaveSettings()
    LAJ.Log("Success", "Added " .. scriptName .. " to favorites")
    return true
end

-- Create enhanced window
local Window = Rayfield:CreateWindow({
    Name = "LAJ HUB " .. LAJ.Version,
    LoadingTitle = "LAJ HUB ULTRA",
    LoadingSubtitle = "by LAJ Development Team",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "LAJHub",
        FileName = "Configuration"
    },
    Discord = {
        Enabled = true,
        Invite = "lajhubcommunity",
        RememberJoins = true
    },
    KeySystem = true,
    KeySettings = {
        Title = "LAJ HUB " .. LAJ.Version,
        Subtitle = "Premium Key Authentication",
        Note = "Join our Discord for a key: discord.gg/lajhubcommunity",
        FileName = "LAJHubKey",
        SaveKey = true,
        GrabKeyFromSite = false,
        Key = {
            "3W319,4RY20RI,2US82,19RI99", -- Original key
            "LAJHUB-PREMIUM-ACCESS",
            "LAJ-2023-VIP",
            "LAJHUB-ULTRA-2023",
            "ROBLOX-EXPLOITS-PREMIUM",
            "LAJPRO" -- New key
        }
    },
    Theme = LAJ.Config.Theme or "Default"
})

-- Create main UI tabs
local gameInfo = LAJ.GetCurrentGame()

-- Dashboard Tab
local DashboardTab = Window:CreateTab("Dashboard", 4483362458)
local PlayerTab = Window:CreateTab("Player", 4483362458)
local UniversalTab = Window:CreateTab("Universal", 4483362458)
local GamesTab = Window:CreateTab("Games", 4483362458)
local FavoritesTab = Window:CreateTab("Favorites", 4483362458)
local SettingsTab = Window:CreateTab("Settings", 4483362458)

-- Dashboard Content
DashboardTab:CreateSection("üåü Welcome to LAJ HUB " .. LAJ.Version)

local gameInfoLabel = DashboardTab:CreateLabel("üéÆ Current Game: " .. gameInfo.Name .. " (" .. gameInfo.ID .. ")")
local versionLabel = DashboardTab:CreateLabel("üìä Version: " .. LAJ.Version)

DashboardTab:CreateParagraph({
    Title = "LAJ HUB - The Ultimate Exploit Hub",
    Content = "LAJ HUB " .. LAJ.Version .. " provides the best Roblox exploits organized by game categories and types. Navigate through the tabs to find scripts for your favorite games or use universal exploits that work across Roblox."
})

-- Game-specific recommendations
if gameInfo.Name ~= "Universal" then
    DashboardTab:CreateSection("üìã Recommendations for " .. gameInfo.Name)
    
    -- Add button to directly execute TrixAde script if available
    if gameInfo.Script then
        DashboardTab:CreateButton({
            Name = "‚ö° Execute TrixAde Script for " .. gameInfo.Name,
            Info = "Run the most compatible TrixAde script for " .. gameInfo.Name,
            Callback = function()
                LAJ.Log("Info", "Executing TrixAde script for " .. gameInfo.Name)
                LAJ.LoadScript(gameInfo.Script, gameInfo.Name .. " (TrixAde)")
            end,
        })
    end
    
    DashboardTab:CreateButton({
        Name = "üöÄ Load All Scripts for " .. gameInfo.Name,
        Info = "Quick access to all scripts for " .. gameInfo.Name,
        Callback = function()
            LAJ.Log("Info", "Loading recommended scripts for " .. gameInfo.Name)
            GamesTab:Select()
            
            -- Finding the appropriate game category
            for i, v in pairs(LAJ.Games) do
                if i == gameInfo.Name then
                    -- We would automatically highlight or scroll to the correct section
                    -- but Rayfield doesn't support this directly
                    LAJ.Log("Info", "Found " .. gameInfo.Name .. " in category " .. v.Category)
                    break
                end
            end
        end,
    })
end

-- Recent activity section
DashboardTab:CreateSection("üìú Recent Activity")

-- This would be dynamically populated with recent scripts executed
if #LAJ.History > 0 then
    for i = 1, math.min(5, #LAJ.History) do
        local item = LAJ.History[#LAJ.History - (i-1)]
        DashboardTab:CreateButton({
            Name = item.Name,
            Info = "Re-execute this script",
            Callback = function()
                LAJ.LoadScript(item.URL, item.Name)
            end,
        })
    end
else
    DashboardTab:CreateLabel("No recent activity")
end

-- Discord & Community
DashboardTab:CreateSection("üåê Community")

DashboardTab:CreateButton({
    Name = "üîó Join Discord",
    Info = "Join our community for updates and support",
    Callback = function()
        if setclipboard then
            setclipboard("discord.gg/lajhubcommunity")
            LAJ.Log("Info", "Discord invite copied to clipboard")
        else
            LAJ.Log("Warning", "Clipboard function not available")
        end
    end,
})

-- Player Tab
PlayerTab:CreateSection("üßç Player Utilities")

-- ESP Features
local espEnabled = false
PlayerTab:CreateToggle({
    Name = "üîç ESP / Wallhack",
    Info = "See players through walls",
    CurrentValue = false,
    Flag = "ESPEnabled",
    Callback = function(Value)
        espEnabled = Value
        if Value then
            LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/espwallhack", "ESP Wallhack")
        else
            LAJ.Log("Info", "ESP disabled - rejoin to fully remove")
        end
    end,
})

-- Teleport utilities
PlayerTab:CreateSection("üèÉ Movement & Teleport")

PlayerTab:CreateToggle({
    Name = "üèéÔ∏è Speed Boost",
    Info = "Increase character's movement speed",
    CurrentValue = false,
    Flag = "SpeedBoostEnabled",
    Callback = function(Value)
        -- Speed boost code
        if Value then
            local humanoid = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                LAJ.Cache.OriginalWalkSpeed = humanoid.WalkSpeed
                humanoid.WalkSpeed = 50
                LAJ.Log("Info", "Speed boost enabled")
            else
                LAJ.Log("Error", "Humanoid not found")
            end
        else
            local humanoid = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid and LAJ.Cache.OriginalWalkSpeed then
                humanoid.WalkSpeed = LAJ.Cache.OriginalWalkSpeed
                LAJ.Log("Info", "Speed boost disabled")
            end
        end
    end,
})

PlayerTab:CreateToggle({
    Name = "ü¶ò Jump Power",
    Info = "Increase character's jump height",
    CurrentValue = false,
    Flag = "JumpPowerEnabled",
    Callback = function(Value)
        -- Jump power code
        if Value then
            local humanoid = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                LAJ.Cache.OriginalJumpPower = humanoid.JumpPower
                humanoid.JumpPower = 100
                LAJ.Log("Info", "Jump power enhanced")
            else
                LAJ.Log("Error", "Humanoid not found")
            end
        else
            local humanoid = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid and LAJ.Cache.OriginalJumpPower then
                humanoid.JumpPower = LAJ.Cache.OriginalJumpPower
                LAJ.Log("Info", "Jump power reset")
            end
        end
    end,
})

PlayerTab:CreateToggle({
    Name = "ü¶Ö Fly (Risk)",
    Info = "Makes your character fly (High ban risk)",
    CurrentValue = false,
    Flag = "FlyEnabled",
    Callback = function(Value)
        if Value then
            LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/fly", "Fly Script")
        else
            LAJ.Log("Info", "Fly disabled - rejoin to fully remove")
        end
    end,
})

-- Universal Scripts Tab
UniversalTab:CreateSection("üåç Universal Admin Scripts")

UniversalTab:CreateButton({
    Name = "‚å®Ô∏è Infinite Yield",
    Info = "Admin commands script",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source", "Infinite Yield")
    end,
})

UniversalTab:CreateButton({
    Name = "üõ†Ô∏è Domain X",
    Info = "Advanced admin commands",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/shlexware/DomainX/main/source", "Domain X")
    end,
})

UniversalTab:CreateButton({
    Name = "‚öôÔ∏è CMD-X Admin",
    Info = "Comprehensive admin command system",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/CMD-X/CMD-X/master/Source", "CMD-X Admin")
    end,
})

-- Universal utilities section
UniversalTab:CreateSection("üîß Universal Utilities")

UniversalTab:CreateButton({
    Name = "üéØ Aimbot",
    Info = "Universal aimbot script",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/aimbot", "Universal Aimbot")
    end,
})

UniversalTab:CreateButton({
    Name = "üëÅÔ∏è Universal ESP",
    Info = "ESP that works across games",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/esp", "Universal ESP")
    end,
})

UniversalTab:CreateButton({
    Name = "üîç Remote Spy",
    Info = "Monitor remote events and functions",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/remotespy", "Remote Spy")
    end,
})

-- Da Strike Section (retained from original)
UniversalTab:CreateSection("‚öîÔ∏è Da Strike")

UniversalTab:CreateButton({
    Name = "üìú Psalm",
    Info = "Da Strike exploit script",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/NewWhitelistService/l/refs/heads/main/psalms%20old.lua", "Psalm")
    end,
})

UniversalTab:CreateButton({
    Name = "üîÆ Ballware VFS",
    Info = "Advanced Da Strike script",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/DHBCommunity/DHBOfficialScript/refs/heads/main/Protected_4021809531880627.txt", "Ballware VFS")
    end,
})

UniversalTab:CreateButton({
    Name = "‚ùÑÔ∏è FrostByte",
    Info = "Premium Da Strike exploit",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/Totocoems/Frostbyte-/main/Frostbyte%20leak", "FrostByte")
    end,
})

-- Fishing Scripts Section (retained from original)
UniversalTab:CreateSection("üé£ Fishing")

UniversalTab:CreateButton({
    Name = "üéÆ Ronix",
    Info = "Fishing game exploit",
    Callback = function()
        LAJ.LoadScript("https://api.luarmor.net/files/v3/loaders/a3c501e721ec4d66a864cc2276c0f4e9.lua", "Ronix")
    end,
})

UniversalTab:CreateButton({
    Name = "‚ö° Speed Hub",
    Info = "Speed Hub X fishing scripts",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua", "Speed Hub")
    end,
})

-- Games Tab (Replaces the old PopularTab)
-- Organize by game categories
GamesTab:CreateSection("üîç Game Script Search")

-- Game search functionality
local gameSearchInput = GamesTab:CreateInput({
    Name = "üîé Search Games",
    Info = "Enter game name to find scripts",
    PlaceholderText = "Example: Arsenal, Blox Fruits...",
    Flag = "GameSearchInput",
    RemoveTextAfterFocusLost = false,
    Callback = function(Text)
        -- Simple search logic (would be more advanced in a real implementation)
        local searchText = string.lower(Text)
        for gameName, gameData in pairs(LAJ.Games) do
            if string.find(string.lower(gameName), searchText) then
                LAJ.Log("Info", "Found matching game: " .. gameName)
                -- This would ideally scroll to that section, but we'd need to implement that
            end
        end
    end,
})

-- Add TrixAde collection section
GamesTab:CreateSection("üåü TrixAde Scripts Collection")

-- Add explanation about TrixAde scripts
GamesTab:CreateParagraph({
    Title = "TrixAde Script Collection",
    Content = "Below you'll find a comprehensive collection of scripts from TrixAde, one of the most respected script developers in the Roblox community. These scripts are maintained regularly and provide powerful exploits for a wide variety of popular games."
})

-- Create dynamic buttons for all games with TrixAde scripts
local trixGameCount = 0
for gameName, gameData in pairs(LAJ.Games) do
    if gameData.Script then
        trixGameCount = trixGameCount + 1
        
        GamesTab:CreateButton({
            Name = "‚ö° " .. gameName,
            Info = "TrixAde script for " .. gameName,
            Callback = function()
                LAJ.LoadScript(gameData.Script, gameName .. " (TrixAde)")
            end,
        })
        
        -- Create groups of 5 games to avoid cluttering the UI
        if trixGameCount % 5 == 0 then
            GamesTab:CreateParagraph({
                Title = "",
                Content = "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
            })
        end
    end
end

-- FPS Games Category
GamesTab:CreateSection("üéØ FPS Games")

-- Arsenal
GamesTab:CreateParagraph({
    Title = "Arsenal",
    Content = "Competitive first-person shooter game where players eliminate opponents with various weapons to earn points and win rounds.",
})

GamesTab:CreateButton({
    Name = "üî´ Dark Hub",
    Info = "Advanced aimbot, ESP, and more for Arsenal",
    Callback = function()
        LAJ.LoadScript("https://darkhub.xyz/remote-script.lua", "Dark Hub")
    end,
})

GamesTab:CreateButton({
    Name = "ü¶â Owl Hub",
    Info = "Universal FPS script compatible with Arsenal",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/CriShoux/OwlHub/master/OwlHub.txt", "Owl Hub")
    end,
})

GamesTab:CreateButton({
    Name = "üéØ Arsenal Aimbot Pro",
    Info = "Premium Arsenal aimbot with wallhack",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/arsenal", "Arsenal Aimbot Pro")
    end,
})

-- Add favorite button with dynamic state
local arsenalFavBtn = GamesTab:CreateButton({
    Name = LAJ.IsFavorite("Arsenal Scripts") and "‚≠ê Remove from Favorites" or "‚òÜ Add to Favorites",
    Info = "Toggle favorite status for Arsenal scripts",
    Callback = function()
        local isFav = LAJ.ToggleFavorite("Arsenal Scripts", "CATEGORY:Arsenal")
        arsenalFavBtn:Set({
            Name = isFav and "‚≠ê Remove from Favorites" or "‚òÜ Add to Favorites"
        })
    end,
})

-- Phantom Forces
GamesTab:CreateParagraph({
    Title = "Phantom Forces",
    Content = "Tactical first-person shooter with advanced weapon mechanics and multiple gameplay modes.",
})

GamesTab:CreateButton({
    Name = "üéØ Strucid Silent Aim",
    Info = "Silent aim and ESP for Phantom Forces",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/VoidMasterX/strawhook/main/script.lua", "Strucid Silent Aim")
    end,
})

GamesTab:CreateButton({
    Name = "üéÆ GOODWILL",
    Info = "Advanced combat suite for Phantom Forces",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/Stefanuk12/ROBLOX/master/Games/Phantom%20Forces/GOODWILL", "GOODWILL")
    end,
})

-- RPG Games Category
GamesTab:CreateSection("‚öîÔ∏è RPG Games")

-- Blox Fruits
GamesTab:CreateParagraph({
    Title = "Blox Fruits",
    Content = "One Piece inspired game where players collect fruits, fight bosses, and gain power through various means.",
})

GamesTab:CreateButton({
    Name = "üçé Mukuro Hub",
    Info = "Complete Blox Fruits exploit suite",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/xQuartyx/DonateMe/main/ScriptLoader", "Mukuro Hub")
    end,
})

GamesTab:CreateButton({
    Name = "‚ö° Ripper Hub",
    Info = "Auto-farm and combat scripts for Blox Fruits",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/hajibeza/RIPPER-HUB/main/BF.lua", "Ripper Hub")
    end,
})

GamesTab:CreateButton({
    Name = "üé≠ Hoho Hub",
    Info = "Premium Blox Fruits features and automation",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/acsu123/HOHO_H/main/Loading_UI", "Hoho Hub")
    end,
})

-- Fighting Games Category
GamesTab:CreateSection("üëä Fighting Games")

-- Da Hood
GamesTab:CreateParagraph({
    Title = "Da Hood",
    Content = "Urban roleplaying game focused on streetfighting, robberies, and territory control.",
})

GamesTab:CreateButton({
    Name = "üåÄ Vortex Hub",
    Info = "All-in-one Da Hood script",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/ImagineProxy/vortex/main/main", "Vortex Hub")
    end,
})

GamesTab:CreateButton({
    Name = "üî´ Ray X",
    Info = "Silent aim and combat for Da Hood",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/SpaceYes/Lua/Main/DaHood.Lua", "Ray X")
    end,
})

GamesTab:CreateButton({
    Name = "üòé Swag Mode",
    Info = "Popular Da Hood script with premium features",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/lerkermer/lua-projects/master/SwagModeV002", "Swag Mode")
    end,
})

-- Simulation Games
GamesTab:CreateSection("üåé Simulation Games")

-- Fishing Simulator
GamesTab:CreateParagraph({
    Title = "Fishing Simulator",
    Content = "Catch fish, upgrade equipment, and explore the world in this relaxing simulator game.",
})

GamesTab:CreateButton({
    Name = "üéÆ Ronix",
    Info = "Auto-fishing and item collection",
    Callback = function()
        LAJ.LoadScript("https://api.luarmor.net/files/v3/loaders/a3c501e721ec4d66a864cc2276c0f4e9.lua", "Ronix")
    end,
})

GamesTab:CreateButton({
    Name = "‚ö° Speed Hub",
    Info = "Multi-game hub with Fishing Simulator support",
    Callback = function()
        LAJ.LoadScript("https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua", "Speed Hub")
    end,
})

-- Favorites Tab
FavoritesTab:CreateSection("‚≠ê Your Favorite Scripts")

if LAJ.Config.Favorites and #LAJ.Config.Favorites > 0 then
    for _, fav in ipairs(LAJ.Config.Favorites) do
        -- Check if it's a category or direct script
        if string.sub(fav.URL, 1, 9) == "CATEGORY:" then
            -- It's a category favorite
            local categoryName = string.sub(fav.URL, 10)
            FavoritesTab:CreateParagraph({
                Title = "üîñ " .. fav.Name,
                Content = "Category: " .. categoryName .. "\nAdded: " .. os.date("%Y-%m-%d", fav.AddedAt)
            })
            
            FavoritesTab:CreateButton({
                Name = "üîÑ Go to Category",
                Info = "Navigate to this game category",
                Callback = function()
                    GamesTab:Select()
                    LAJ.Log("Info", "Navigated to " .. categoryName .. " category")
                end,
            })
        else
            -- It's a direct script favorite
            FavoritesTab:CreateButton({
                Name = "‚ö° " .. fav.Name,
                Info = "Execute this favorite script",
                Callback = function()
                    LAJ.LoadScript(fav.URL, fav.Name)
                end,
            })
        end
        
        -- Add remove from favorites button
        FavoritesTab:CreateButton({
            Name = "‚ùå Remove from Favorites",
            Info = "Remove " .. fav.Name .. " from favorites",
            Callback = function()
                LAJ.ToggleFavorite(fav.Name, fav.URL)
                -- This would ideally refresh the UI, but we'd need to implement that
                LAJ.Log("Info", "Removed " .. fav.Name .. " from favorites. Restart to see changes.")
            end,
        })
    end
else
    FavoritesTab:CreateLabel("No favorites added yet")
    FavoritesTab:CreateParagraph({
        Title = "How to Add Favorites",
        Content = "Look for the '‚òÜ Add to Favorites' buttons throughout the hub to add scripts to your favorites list for quick access."
    })
end

-- Premium Scripts Tab
local premiumScripts = {
    {
        Name = "ü§ñ LAJ Auto Farm Suite",
        Info = "Comprehensive automation for multiple games",
        URL = "https://raw.githubusercontent.com/LAJHubPremium/scripts/main/autofarm"
    },
    {
        Name = "üéØ LAJ Silent Aim (Universal)",
        Info = "Advanced targeting system that works in most games",
        URL = "https://raw.githubusercontent.com/LAJHubPremium/scripts/main/silentaim"
    },
    {
        Name = "üëÅÔ∏è LAJ ESP & Wallhack Pro",
        Info = "Premium ESP with advanced features",
        URL = "https://raw.githubusercontent.com/LAJHubPremium/scripts/main/espwallhack"
    },
    {
        Name = "‚ö° LAJ Teleport Suite",
        Info = "Advanced teleportation with waypoints",
        URL = "https://raw.githubusercontent.com/LAJHubPremium/scripts/main/teleport"
    },
    {
        Name = "üí∞ LAJ Money Maker",
        Info = "Currency exploits for supported games",
        URL = "https://raw.githubusercontent.com/LAJHubPremium/scripts/main/moneymaker"
    },
    {
        Name = "üîì LAJ Unlock All",
        Info = "Unlock items, weapons, and cosmetics",
        URL = "https://raw.githubusercontent.com/LAJHubPremium/scripts/main/unlocker"
    },
    {
        Name = "üîß LAJ Server Crasher",
        Info = "High-risk utility to crash servers (use with caution)",
        URL = "https://raw.githubusercontent.com/LAJHubPremium/scripts/main/servercrash"
    }
}

-- PremiumTab is already defined above, so we don't need to create it again
PremiumTab:CreateSection("üíé Premium Scripts")

PremiumTab:CreateParagraph({
    Title = "Premium LAJ HUB Access",
    Content = "These exclusive scripts are only available to LAJ HUB ULTRA members. They offer advanced features, regular updates, and detection bypasses for a safer exploiting experience."
})

for _, script in ipairs(premiumScripts) do
    PremiumTab:CreateButton({
        Name = script.Name,
        Info = script.Info,
        Callback = function()
            LAJ.LoadScript(script.URL, string.sub(script.Name, 4)) -- Remove emoji from name
        end,
    })
end

-- Settings Tab
SettingsTab:CreateSection("‚öôÔ∏è Interface Settings")

-- Theme Selector
local ThemeDropdown = SettingsTab:CreateDropdown({
    Name = "üé® Theme",
    Options = {"Default", "Light", "Dark", "Midnight", "Sentinel", "Synapse"},
    CurrentOption = LAJ.Config.Theme or "Default",
    Flag = "ThemeOption",
    Callback = function(Value)
        LAJ.Config.Theme = Value
        LAJ.SaveSettings()
        LAJ.Log("Success", "Theme changed to " .. Value .. ". Restart to apply.")
    end,
})

-- UI Scale
SettingsTab:CreateSlider({
    Name = "üìè UI Scale",
    Range = {0.5, 1.5},
    Increment = 0.1,
    Suffix = "x",
    CurrentValue = LAJ.Config.UIScale or 1,
    Flag = "UIScaleSlider",
    Callback = function(Value)
        LAJ.Config.UIScale = Value
        LAJ.SaveSettings()
        -- Scale would be applied if Rayfield supported it
        LAJ.Log("Info", "UI Scale set to " .. Value .. "x")
    end,
})

-- Auto Execute Settings
SettingsTab:CreateSection("üîÑ Auto Execute")

-- List of scripts that can be auto-executed
local autoExecuteScripts = {
    "Infinite Yield",
    "ESP",
    "Silent Aim",
    "FPS Booster",
    "Anti-AFK"
}

for _, scriptName in ipairs(autoExecuteScripts) do
    SettingsTab:CreateToggle({
        Name = "Auto Execute " .. scriptName,
        CurrentValue = LAJ.Config.AutoExecute and LAJ.Config.AutoExecute[scriptName] or false,
        Flag = "AutoExecute" .. scriptName:gsub(" ", ""),
        Callback = function(Value)
            LAJ.Config.AutoExecute = LAJ.Config.AutoExecute or {}
            LAJ.Config.AutoExecute[scriptName] = Value
            LAJ.SaveSettings()
            LAJ.Log("Info", "Auto Execute for " .. scriptName .. " set to " .. tostring(Value))
        end,
    })
end

-- Advanced Settings
SettingsTab:CreateSection("‚ö†Ô∏è Advanced Settings")

SettingsTab:CreateToggle({
    Name = "üîí Safe Mode",
    Info = "Adds extra protection against detection",
    CurrentValue = LAJ.Config.SafeMode or true,
    Flag = "SafeMode",
    Callback = function(Value)
        LAJ.Config.SafeMode = Value
        LAJ.SaveSettings()
        LAJ.Log("Info", "Safe Mode set to " .. tostring(Value))
    end,
})

SettingsTab:CreateToggle({
    Name = "üìù Debug Logging",
    Info = "Save detailed logs for troubleshooting",
    CurrentValue = LAJ.Config.DebugLogging or false,
    Flag = "DebugLogging",
    Callback = function(Value)
        LAJ.Config.DebugLogging = Value
        LAJ.SaveSettings()
        LAJ.Log("Info", "Debug Logging set to " .. tostring(Value))
    end,
})

SettingsTab:CreateButton({
    Name = "üóëÔ∏è Clear Settings",
    Info = "Reset all settings to default",
    Callback = function()
        -- Confirm first
        Rayfield:Notify({
            Title = "Confirm Reset",
            Content = "Are you sure you want to reset all settings?",
            Duration = 10,
            Actions = {
                Confirm = {
                    Name = "Yes",
                    Callback = function()
                        LAJ.Config = {
                            Theme = "Default",
                            AutoExecute = {},
                            UIScale = 1,
                            Favorites = {},
                            SafeMode = true,
                            DebugLogging = false
                        }
                        LAJ.SaveSettings()
                        LAJ.Log("Success", "Settings reset to default")
                    end
                },
                Cancel = {
                    Name = "No",
                    Callback = function()
                        LAJ.Log("Info", "Settings reset cancelled")
                    end
                }
            }
        })
    end,
})

-- Credits Section
SettingsTab:CreateSection("‚ÑπÔ∏è About & Credits")

SettingsTab:CreateParagraph({
    Title = "LAJ HUB " .. LAJ.Version,
    Content = "Developed by: LAJ Development Team\n\nThanks for using LAJ HUB! Join our Discord for updates, key giveaways, and support."
})

SettingsTab:CreateButton({
    Name = "üîó Join Discord",
    Info = "Get support and updates",
    Callback = function()
        if setclipboard then
            setclipboard("discord.gg/lajhubcommunity")
            LAJ.Log("Info", "Discord invite copied to clipboard")
        end
    end,
})

SettingsTab:CreateButton({
    Name = "‚≠ê Rate Us",
    Info = "Rate LAJ HUB on our website",
    Callback = function()
        LAJ.Log("Info", "Thanks for considering rating us!")
    end,
})

-- Auto Execute Logic
if LAJ.Config.AutoExecute then
    for scriptName, enabled in pairs(LAJ.Config.AutoExecute) do
        if enabled then
            if scriptName == "Infinite Yield" then
                LAJ.LoadScript("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source", "Infinite Yield (Auto)")
            elseif scriptName == "ESP" then
                LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/esp", "ESP (Auto)")
            elseif scriptName == "Silent Aim" then
                LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/silentaim", "Silent Aim (Auto)")
            elseif scriptName == "FPS Booster" then
                LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/fpsbooster", "FPS Booster (Auto)")
            elseif scriptName == "Anti-AFK" then
                LAJ.LoadScript("https://raw.githubusercontent.com/LAJHubPremium/scripts/main/antiafk", "Anti-AFK (Auto)")
            end
        end
    end
end

-- TrixAde Auto-Detection System
-- This automatically detects and offers to run TrixAde scripts for the current game
if gameInfo.Script then
    Rayfield:Notify({
        Title = "TrixAde Script Available!",
        Content = "A compatible TrixAde script was found for " .. gameInfo.Name .. ". Would you like to execute it?",
        Duration = 10,
        Actions = {
            Accept = {
                Name = "Yes",
                Callback = function()
                    LAJ.LoadScript(gameInfo.Script, gameInfo.Name .. " (TrixAde)")
                    LAJ.Log("Success", "Executed TrixAde script for " .. gameInfo.Name)
                end
            },
            Decline = {
                Name = "No",
                Callback = function()
                    LAJ.Log("Info", "TrixAde script execution declined")
                end
            }
        }
    })
end

-- Select appropriate tab based on game
local currentGame = LAJ.GetCurrentGame()
if currentGame.Name ~= "Universal" then
    GamesTab:Select()
else
    DashboardTab:Select()
end

-- Final initialization
Rayfield:LoadConfiguration()

-- Display welcome message
LAJ.Log("Success", "LAJ HUB " .. LAJ.Version .. " loaded successfully!")
