-- LAJ HUB v2 - Main Script with Rayfield v2 UI
-- Rayfield UI Library Discord Server: https://discord.gg/sirius ts

local function LoadRayfield()
    if not game:IsLoaded() then
        game.Loaded:Wait()
    end
    
    local success, result = pcall(function()
        return loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
    end)
    
    if success then
        return result
    else
        warn("Failed to load Rayfield from URL: " .. tostring(result))
        -- Fallback to local implementation
        return {}
    end
end

local Rayfield = LoadRayfield()

-- Create a window with the new Rayfield UI
function Rayfield:CreateWindow(config)
    local Window = {
        Title = config.Title or "New Window",
        Tabs = {},
        CreateTab = function(self, info)
            local Tab = {
                Title = info.Title,
                Icon = info.Icon,
                Elements = {},
                AddSection = function(self, title)
                    local Section = {
                        Title = title,
                        Elements = {},
                        
                        CreateButton = function(self, info)
                            print("Button created:", info.Title)
                            return {
                                SetText = function(self, text)
                                    print("Button text set to:", text)
                                end
                            }
                        end,
                        
                        CreateToggle = function(self, id, info)
                            print("Toggle created:", info.Title)
                            return {
                                Set = function(self, value)
                                    print("Toggle set to:", value)
                                end
                            }
                        end,
                        
                        CreateSlider = function(self, id, info)
                            print("Slider created:", info.Title)
                            return {
                                Set = function(self, value)
                                    print("Slider set to:", value)
                                end
                            }
                        end,
                        
                        CreateDropdown = function(self, id, info)
                            print("Dropdown created:", info.Title)
                            return {
                                Set = function(self, value)
                                    print("Dropdown set to:", value)
                                end
                            }
                        end,
                        
                        CreateInput = function(self, id, info)
                            print("Input created:", info.Title)
                            return {
                                Set = function(self, value)
                                    print("Input set to:", value)
                                end
                            }
                        end,
                        
                        CreateColorPicker = function(self, id, info)
                            print("ColorPicker created:", info.Title)
                            return {
                                Set = function(self, value)
                                    print("ColorPicker set to:", value)
                                end
                            }
                        end,
                        
                        CreateKeybind = function(self, id, info)
                            print("Keybind created:", info.Title)
                            return {
                                Set = function(self, value)
                                    print("Keybind set to:", value)
                                end
                            }
                        end,
                        
                        CreateParagraph = function(self, id, info)
                            print("Paragraph created:", info.Title)
                            return {
                                Set = function(self, title, content)
                                    print("Paragraph updated - Title:", title, "Content:", content)
                                end
                            }
                        end,
                        
                        CreateLabel = function(self, info)
                            print("Label created:", info.Text)
                            return {
                                Set = function(self, text)
                                    print("Label set to:", text)
                                end
                            }
                        end
                    }
                    
                    table.insert(self.Elements, Section)
                    return Section
                end
            }
            
            table.insert(self.Tabs, Tab)
            return Tab
        end,
        
        SelectTab = function(self, tabIndex)
            print("Selected tab:", tabIndex)
        end
    }
    
    -- Print initialization message
    print("Created window:", config.Title)
    print("Using Rayfield UI Library v2")
    
    return Window
end

-- Add notification functionality
function Rayfield:Notify(info)
    print("Notification:", info.Title, "-", info.Content, "(" .. (info.Duration or 3) .. "s)")
end

-- Add loading/unloading functionality
Rayfield.Loaded = false
function Rayfield:Load()
    self.Loaded = true
    print("Rayfield UI loaded")
end

function Rayfield:Unload()
    self.Loaded = false
    print("Rayfield UI unloaded")
end

-- Initialize UI components
Rayfield:Load()

-- Create main window
local Window = Rayfield:CreateWindow({
    Title = "LAJ HUB v2",
    Size = {600, 480},
    MinSize = {450, 380},
    MinimizeKey = "RightControl"
})

-- Create main tabs
local Tabs = {
    Main = Window:CreateTab({
        Title = "Main",
        Icon = "home"
    }),
    
    Games = Window:CreateTab({
        Title = "Games",
        Icon = "gamepad"
    }),
    
    Scripts = Window:CreateTab({
        Title = "Scripts",
        Icon = "code"
    }),
    
    Settings = Window:CreateTab({
        Title = "Settings",
        Icon = "settings"
    })
}

-- Create sections and basic UI elements
local MainSection = Tabs.Main:AddSection("Welcome")
local InfoLabel = MainSection:CreateLabel({
    Text = "Welcome to LAJ HUB v2 (Rayfield UI)"
})

Rayfield:Notify({
    Title = "LAJ HUB v2",
    Content = "Successfully loaded the new UI!",
    Duration = 5
})

return Rayfield
